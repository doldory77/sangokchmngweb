<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
                        
<mapper namespace="org.sangokch.mapper.AdmstMapper">
	<select id="selectAdmstList" parameterType="hashmap" resultType="Admst">
		SELECT
			id,
			name,
			super_yn,
			use_yn,
			attr
		FROM admst
		WHERE 1=1		
		<if test='id neq null and id neq ""'>
			and id = #{id}		
		</if>
		<if test='passwd neq null and passwd neq ""'>
			and passwd = MD5(#{passwd})		
		</if>
		<if test='use_yn neq null and use_yn neq ""'>
			and use_yn = 'Y'		
		</if>
	</select>
	<insert id="insertAdmst" parameterType="Admst">
		INSERT INTO admst (
			id,
			name,
			passwd,
			attr
		) VALUES (
			#{id},
			#{name},
			MD5(#{passwd}),
			#{attr}
		)	
	</insert>
	<update id="updateAdmst" parameterType="Admst">
		UPDATE admst SET
			name = #{name},
			super_yn = IFNULL(#{super_yn}, 'N'),
			use_yn = #{use_yn},
			attr = #{attr}
		WHERE id = #{id}
	</update>
	<delete id="deleteAdmst" parameterType="Admst">
		UPDATE admst SET
			use_yn = 'N'
		WHERE id = #{id}
	</delete>
	
	<select id="selectAuth" parameterType="hashmap" resultType="Auth">
		SELECT
			a.id,
			a.authority_cd,
			b.menu_nm AS authority_nm
		FROM authority a, 
			menu b
		WHERE a.authority_cd = b.menu_cd 
			AND a.id = #{id}
		ORDER BY a.authority_cd
	</select>
	<insert id="insertAuth" parameterType="Auth">
		INSERT INTO authority (
			id,
			authority_cd
		) VALUES (
			#{id},
			#{authority_cd}
		)
	</insert>
	<delete id="deleteAuth" parameterType="Auth">
		DELETE FROM authority where id = #{id} AND authority_cd = #{authority_cd}
	</delete>
	<select id="selectAuthority" parameterType="Admst" resultType="string">
		SELECT
			authority_cd
		FROM authority
		WHERE id = #{id}	
	</select>
	
</mapper>